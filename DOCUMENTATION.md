# ğŸ­ FaceLab - à¹€à¸­à¸à¸ªà¸²à¸£à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸‰à¸šà¸±à¸šà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ

## à¸ªà¸²à¸£à¸šà¸±à¸

1. [à¸ à¸²à¸à¸£à¸§à¸¡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œ](#1-à¸ à¸²à¸à¸£à¸§à¸¡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œ)
2. [à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸£à¸°à¸šà¸š](#2-à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸£à¸°à¸šà¸š)
3. [à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸° Dependencies](#3-à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°-dependencies)
4. [à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ](#4-à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ)
5. [Frontend - React Application](#5-frontend---react-application)
6. [Backend - Python Services](#6-backend---python-services)
7. [API Endpoints](#7-api-endpoints)
8. [Routes à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”](#8-routes-à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”)
9. [Components à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”](#9-components-à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”)
10. [à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸ªà¸µ](#10-à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸ªà¸µ)
11. [à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™](#11-à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™)

---

## 1. à¸ à¸²à¸à¸£à¸§à¸¡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œ

### 1.1 FaceLab à¸„à¸·à¸­à¸­à¸°à¹„à¸£?

FaceLab à¹€à¸›à¹‡à¸™à¹€à¸§à¹‡à¸šà¹à¸­à¸›à¸à¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¸ªà¸³à¸«à¸£à¸±à¸š **AI Face Swap** (à¸ªà¸¥à¸±à¸šà¹ƒà¸šà¸«à¸™à¹‰à¸²) à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ Deep Learning à¹‚à¸”à¸¢à¹€à¸‰à¸à¸²à¸° **SimSwap** à¸‹à¸¶à¹ˆà¸‡à¹€à¸›à¹‡à¸™à¹‚à¸¡à¹€à¸”à¸¥ AI à¸—à¸µà¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–:

- **Single Face Swap** - à¸ªà¸¥à¸±à¸šà¹ƒà¸šà¸«à¸™à¹‰à¸²à¹€à¸”à¸µà¹ˆà¸¢à¸§ (1 à¸•à¹ˆà¸­ 1)
- **Multi Face Swap** - à¸ªà¸¥à¸±à¸šà¸«à¸¥à¸²à¸¢à¹ƒà¸šà¸«à¸™à¹‰à¸²à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™
- **Color Editor** - à¸›à¸£à¸±à¸šà¸ªà¸µ à¸„à¸§à¸²à¸¡à¸ªà¸§à¹ˆà¸²à¸‡ contrast à¹à¸¥à¸°à¸„à¸£à¸­à¸›à¸ à¸²à¸

### 1.2 à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰

| Layer | Technology | Version |
|-------|------------|---------|
| Frontend | React | 19.2.0 |
| Build Tool | Vite | 7.2.4 |
| Routing | React Router DOM | 7.11.0 |
| Backend Gateway | FastAPI | â‰¥0.100.0 |
| AI Service | SimSwap + InsightFace | - |
| Deep Learning | PyTorch | â‰¥2.0.0 |
| Face Detection | InsightFace + ONNX | - |

---

## 2. à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸£à¸°à¸šà¸š

### 2.1 à¸ à¸²à¸à¸£à¸§à¸¡à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER (Browser)                              â”‚
â”‚                        http://localhost:5173                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND (React + Vite)                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Pages     â”‚   â”‚ Components  â”‚   â”‚      Services           â”‚  â”‚
â”‚  â”‚             â”‚   â”‚             â”‚   â”‚                         â”‚  â”‚
â”‚  â”‚ LandingPage â”‚   â”‚ Layout      â”‚   â”‚  api.js                 â”‚  â”‚
â”‚  â”‚ ServicesPageâ”‚   â”‚ ImageUpload â”‚   â”‚  â”œâ”€ runSimSwap()        â”‚  â”‚
â”‚  â”‚ FaceSwapToolâ”‚   â”‚ ColorEditor â”‚   â”‚  â”œâ”€ runSimSwapMulti()   â”‚  â”‚
â”‚  â”‚ AboutPage   â”‚   â”‚ ResultView  â”‚   â”‚  â””â”€ checkHealth()       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ HTTP Requests (fetch)
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GATEWAY (FastAPI - Port 8000)                    â”‚
â”‚                                                                     â”‚
â”‚  Endpoints:                                                         â”‚
â”‚  â”œâ”€ GET  /health              â†’ Health check                       â”‚
â”‚  â”œâ”€ POST /api/simswap         â†’ Single face swap (proxy)           â”‚
â”‚  â””â”€ POST /api/simswap_multi_upload â†’ Multi face swap (proxy)       â”‚
â”‚                                                                     â”‚
â”‚  CORS enabled for: localhost:5173, localhost:5174, localhost:3000  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ HTTP Proxy (requests library)
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SIMSWAP SERVICE (FastAPI - Port 8001)                â”‚
â”‚                                                                     â”‚
â”‚  Endpoints:                                                         â”‚
â”‚  â”œâ”€ POST /run       â†’ Single face swap with SimSwap model          â”‚
â”‚  â””â”€ POST /run_multi â†’ Multi face swap with SimSwap model           â”‚
â”‚                                                                     â”‚
â”‚  Uses: SimSwap neural network, InsightFace for face detection      â”‚
â”‚  Storage: shared_storage/uploads/ and shared_storage/outputs/      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 à¸—à¸³à¹„à¸¡à¸•à¹‰à¸­à¸‡à¹à¸¢à¸ Gateway à¸à¸±à¸š Service?

**à¹€à¸«à¸•à¸¸à¸œà¸¥à¹ƒà¸™à¸à¸²à¸£à¸­à¸­à¸à¹à¸šà¸š:**

1. **Separation of Concerns** - Gateway à¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸š routing, CORS, static files à¸ªà¹ˆà¸§à¸™ Service à¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸š AI processing
2. **Scalability** - à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸à¸´à¹ˆà¸¡ Service à¸­à¸·à¹ˆà¸™à¹† à¹„à¸”à¹‰à¹ƒà¸™à¸­à¸™à¸²à¸„à¸• (à¹€à¸Šà¹ˆà¸™ DiFaReLi)
3. **Different Conda Environments** - Gateway à¹ƒà¸Šà¹‰ `web` env (à¹€à¸šà¸²), SimSwap à¹ƒà¸Šà¹‰ `simswap` env (à¸¡à¸µ PyTorch, CUDA)
4. **Isolation** - à¸–à¹‰à¸² AI Service crash, Gateway à¸¢à¸±à¸‡à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰
5. **CORS Handling** - à¸ˆà¸±à¸”à¸à¸²à¸£ CORS à¸—à¸µà¹ˆà¸ˆà¸¸à¸”à¹€à¸”à¸µà¸¢à¸§

---

## 3. à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸° Dependencies

### 3.1 Frontend Dependencies (package.json)

```json
{
  "dependencies": {
    "@supabase/supabase-js": "^2.89.0",   // Authentication (optional)
    "react": "^19.2.0",                    // UI Library
    "react-dom": "^19.2.0",                // React DOM rendering
    "react-router-dom": "^7.11.0"          // Client-side routing
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^5.1.1",      // Vite React plugin
    "vite": "^7.2.4",                       // Build tool
    "eslint": "^9.39.1"                     // Code linting
  }
}
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ React 19?**
- Concurrent rendering à¸—à¸³à¹ƒà¸«à¹‰ UI responsive à¸‚à¸“à¸°à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥
- Automatic batching à¸¥à¸” re-renders
- Suspense improvements à¸ªà¸³à¸«à¸£à¸±à¸š loading states

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ Vite à¹à¸—à¸™ Create React App?**
- à¹€à¸£à¹‡à¸§à¸à¸§à¹ˆà¸² 10-100 à¹€à¸—à¹ˆà¸²à¹ƒà¸™à¸à¸²à¸£ dev
- Hot Module Replacement (HMR) à¸—à¸±à¸™à¸—à¸µ
- Build à¸”à¹‰à¸§à¸¢ Rollup à¸—à¸µà¹ˆ optimized

### 3.2 Backend Dependencies (requirements.txt)

```
# Core Web Framework
fastapi>=0.100.0      # Modern async Python web framework
uvicorn>=0.23.0       # ASGI server
python-multipart>=0.0.6  # Form file uploads

# Computer Vision
opencv-python>=4.8.0  # Image processing
Pillow>=10.0.0        # Image manipulation

# Deep Learning
torch>=2.0.0          # PyTorch neural networks
torchvision>=0.15.0   # Vision utilities

# Face Detection
insightface>=0.7.3    # Face detection & recognition
onnxruntime>=1.15.0   # ONNX model inference
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ FastAPI?**
- Async by default - à¸£à¸­à¸‡à¸£à¸±à¸š concurrent requests
- Automatic OpenAPI docs
- Type hints = validation + documentation
- à¹€à¸£à¹‡à¸§à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹ƒà¸™ Python frameworks

---

## 4. à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ

```
CS FINALPROJECT/
â”‚
â”œâ”€â”€ frontend/                          # React Frontend
â”‚   â”œâ”€â”€ public/                        # Static assets
â”‚   â”‚   â””â”€â”€ carousel/                  # Carousel images
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/                # Reusable UI components
â”‚   â”‚   â”‚   â”œâ”€â”€ ColorEditor.jsx        # Color/crop editor (588 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUploader.jsx      # Drag-drop uploader
â”‚   â”‚   â”‚   â”œâ”€â”€ ResultDisplay.jsx      # Result comparison view
â”‚   â”‚   â”‚   â”œâ”€â”€ GenerationProgress.jsx # Progress indicator
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.jsx             # Header + Footer wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeToggle.jsx        # Dark/Light mode toggle
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolsPanel.jsx         # Tool selector sidebar
â”‚   â”‚   â”‚   â””â”€â”€ LuxuryCarousel.jsx     # Auto-sliding carousel
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pages/                     # Route pages
â”‚   â”‚   â”‚   â”œâ”€â”€ LandingPage.jsx        # Home page
â”‚   â”‚   â”‚   â”œâ”€â”€ ServicesPage.jsx       # Services listing
â”‚   â”‚   â”‚   â”œâ”€â”€ FaceSwapTool.jsx       # Main tool page (296 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ AboutPage.jsx          # About us
â”‚   â”‚   â”‚   â”œâ”€â”€ ContactPage.jsx        # Contact form
â”‚   â”‚   â”‚   â””â”€â”€ ResearchPage.jsx       # Research info
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ api.js                 # API client functions
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”‚   â””â”€â”€ ThemeContext.jsx       # Theme state management
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.jsx                    # Root component + routing
â”‚   â”‚   â”œâ”€â”€ main.jsx                   # Entry point
â”‚   â”‚   â””â”€â”€ index.css                  # Global styles (447 lines)
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ facelab/                           # Python Backend
â”‚   â”œâ”€â”€ gateway/                       # API Gateway
â”‚   â”‚   â”œâ”€â”€ app.py                     # Gateway endpoints
â”‚   â”‚   â”œâ”€â”€ static/                    # Served result images
â”‚   â”‚   â””â”€â”€ templates/                 # Jinja2 templates
â”‚   â”‚
â”‚   â”œâ”€â”€ Service/
â”‚   â”‚   â”œâ”€â”€ simswap_service/           # SimSwap AI Service
â”‚   â”‚   â”‚   â”œâ”€â”€ app.py                 # Service endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”‚   â”‚   â””â”€â”€ SimSwap/               # SimSwap model code
â”‚   â”‚   â”‚       â”œâ”€â”€ arcface_model/     # Face recognition model
â”‚   â”‚   â”‚       â”œâ”€â”€ checkpoints/       # Pretrained weights
â”‚   â”‚   â”‚       â””â”€â”€ insightface_func/  # Face detection
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ difareli_service/          # (Coming soon)
â”‚   â”‚
â”‚   â””â”€â”€ shared_storage/                # Shared file storage
â”‚       â”œâ”€â”€ uploads/                   # Uploaded images
â”‚       â””â”€â”€ outputs/                   # Generated results
â”‚
â”œâ”€â”€ environment_simswap.yaml           # Conda env for SimSwap
â”œâ”€â”€ environment_web.yaml               # Conda env for Gateway
â”œâ”€â”€ start_facelab.bat                  # Startup script
â””â”€â”€ README.md
```

---

## 5. Frontend - React Application

### 5.1 Entry Point (main.jsx)

```jsx
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.jsx'

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <App />
  </StrictMode>,
)
```

**à¸­à¸˜à¸´à¸šà¸²à¸¢:**
- `StrictMode` - à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¹ƒà¸™à¸à¸²à¸£à¸à¸±à¸’à¸™à¸² (double-render à¹€à¸à¸·à¹ˆà¸­à¸«à¸² side effects)
- `createRoot` - React 18+ Concurrent Mode API
- `index.css` - Global styles à¹‚à¸«à¸¥à¸”à¸à¹ˆà¸­à¸™ App

### 5.2 App Component (App.jsx)

```jsx
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import { ThemeProvider } from './context/ThemeContext';
import Layout from './components/Layout';
// ... page imports

function App() {
    return (
        <ThemeProvider>
            <BrowserRouter>
                <Routes>
                    <Route path="/" element={<Layout />}>
                        <Route index element={<LandingPage />} />
                        <Route path="services" element={<ServicesPage />} />
                        <Route path="about" element={<AboutPage />} />
                        <Route path="contact" element={<ContactPage />} />
                        <Route path="research" element={<ResearchPage />} />
                        <Route path="tool/*" element={<FaceSwapTool />} />
                    </Route>
                </Routes>
            </BrowserRouter>
        </ThemeProvider>
    );
}
```

**à¸­à¸˜à¸´à¸šà¸²à¸¢à¸à¸²à¸£à¸­à¸­à¸à¹à¸šà¸š:**

1. **ThemeProvider à¸„à¸£à¸­à¸šà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”** - à¸—à¸¸à¸ component à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡ theme à¹„à¸”à¹‰
2. **BrowserRouter** - à¹ƒà¸Šà¹‰ HTML5 History API à¸ªà¸³à¸«à¸£à¸±à¸š clean URLs
3. **Nested Routes** - `Layout` à¹€à¸›à¹‡à¸™ parent route à¸—à¸µà¹ˆ render Header/Footer
4. **`path="tool/*"`** - Wildcard route à¸ªà¸³à¸«à¸£à¸±à¸š `/tool/simswap-single`, `/tool/simswap-multi`

### 5.3 Theme Context (ThemeContext.jsx)

```jsx
const ThemeContext = createContext();

export function ThemeProvider({ children }) {
    const [theme, setTheme] = useState(() => {
        // 1. Check localStorage first
        const saved = localStorage.getItem('facelab-theme');
        if (saved) return saved;
        
        // 2. Check system preference
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
        }
        return 'light';
    });

    useEffect(() => {
        // Save to localStorage
        localStorage.setItem('facelab-theme', theme);
        // Apply to HTML element
        document.documentElement.setAttribute('data-theme', theme);
    }, [theme]);

    const toggleTheme = () => {
        setTheme(prev => prev === 'light' ? 'dark' : 'light');
    };

    return (
        <ThemeContext.Provider value={{ theme, toggleTheme }}>
            {children}
        </ThemeContext.Provider>
    );
}
```

**à¸«à¸¥à¸±à¸à¸à¸²à¸£:**
- **Lazy initialization** - useState callback à¸—à¸³à¸‡à¸²à¸™à¸„à¸£à¸±à¹‰à¸‡à¹€à¸”à¸µà¸¢à¸§à¸•à¸­à¸™ mount
- **Persist to localStorage** - à¸ˆà¸³ preference à¸‚à¸­à¸‡ user
- **CSS attribute selector** - à¹ƒà¸Šà¹‰ `[data-theme="dark"]` à¹ƒà¸™ CSS

---

## 6. Backend - Python Services

### 6.1 Gateway (gateway/app.py)

```python
from fastapi import FastAPI, UploadFile, File, HTTPException
from fastapi.middleware.cors import CORSMiddleware
import requests

app = FastAPI(title="FaceLab Hub")

# CORS - à¸­à¸™à¸¸à¸à¸²à¸• Frontend à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:5173", "http://localhost:5174"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

SIMSWAP_URL = "http://127.0.0.1:8001/run"

@app.post("/api/simswap")
def simswap(src: UploadFile = File(...), dst: UploadFile = File(...)):
    # Reset file position
    src.file.seek(0)
    dst.file.seek(0)
    
    # Forward to SimSwap service
    files = {
        "src": (src.filename, src.file, src.content_type),
        "dst": (dst.filename, dst.file, dst.content_type),
    }
    
    r = requests.post(SIMSWAP_URL, files=files, timeout=600)
    
    if r.status_code != 200:
        return JSONResponse(status_code=r.status_code, content={"detail": r.text})
    
    # Save result
    out_path = STATIC_DIR / "simswap_result.png"
    out_path.write_bytes(r.content)
    
    return {"ok": True, "result_url": "/static/simswap_result.png"}
```

**à¸—à¸³à¹„à¸¡à¸•à¹‰à¸­à¸‡ `file.seek(0)`?**
- UploadFile à¸­à¸²à¸ˆà¸–à¸¹à¸à¸­à¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²
- `seek(0)` à¸£à¸µà¹€à¸‹à¹‡à¸• cursor à¸à¸¥à¸±à¸šà¹„à¸›à¸•à¹‰à¸™à¹„à¸Ÿà¸¥à¹Œ

**à¸—à¸³à¹„à¸¡à¸šà¸±à¸™à¸—à¸¶à¸à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ?**
- Frontend load à¸£à¸¹à¸›à¸œà¹ˆà¸²à¸™ `<img src=...>`
- à¸•à¹‰à¸­à¸‡ serve à¹€à¸›à¹‡à¸™ static file

### 6.2 SimSwap Service (simswap_service/app.py)

```python
@app.post("/run")
def run(src: UploadFile = File(...), dst: UploadFile = File(...)):
    # Import heavy ML libraries inside endpoint
    # to allow FastAPI to start without ML dependencies
    try:
        from SimSwap.test_wholeimage_swapsingle import run_swap
    except Exception as e:
        # Fallback for testing without ML
        def run_swap(src, dst, output_dir, **kwargs):
            shutil.copyfile(dst, os.path.join(output_dir, 'result.jpg'))
    
    # Generate unique job ID
    job = uuid.uuid4().hex[:10]
    
    # Save uploaded files
    src_path = UPLOAD / f"{job}_src.png"
    dst_path = UPLOAD / f"{job}_dst.png"
    save_upload(src, src_path)
    save_upload(dst, dst_path)
    
    # Run SimSwap
    run_swap(str(src_path), str(dst_path), str(OUTPUT), crop_size=224)
    
    # Return latest output
    out_img = max(OUTPUT.glob("*.*"), key=lambda p: p.stat().st_mtime)
    return FileResponse(str(out_img))
```

**à¸—à¸³à¹„à¸¡ import à¹ƒà¸™ endpoint?**
- PyTorch + InsightFace à¹ƒà¸Šà¹‰à¹€à¸§à¸¥à¸² load à¸™à¸²à¸™
- à¸–à¹‰à¸² import à¸—à¸µà¹ˆ top-level, FastAPI à¸ˆà¸° start à¸Šà¹‰à¸²à¸¡à¸²à¸
- Lazy import = à¹€à¸£à¹‡à¸§à¸à¸§à¹ˆà¸²

---

## 7. API Endpoints

### 7.1 Gateway Endpoints (Port 8000)

| Method | Endpoint | Description | Request | Response |
|--------|----------|-------------|---------|----------|
| GET | `/` | Hub HTML page | - | HTML |
| GET | `/health` | Health check | - | `{"status": "ok"}` |
| POST | `/api/simswap` | Single face swap | FormData: `src`, `dst` | `{"ok": true, "result_url": "..."}` |
| POST | `/api/simswap_multi_upload` | Multi face swap | FormData: `src[]`, `dst` | `{"ok": true, "result_url": "..."}` |

### 7.2 SimSwap Service Endpoints (Port 8001)

| Method | Endpoint | Description | Request | Response |
|--------|----------|-------------|---------|----------|
| POST | `/run` | Single face swap | FormData: `src`, `dst` | Image bytes (PNG) |
| POST | `/run_multi` | Multi face swap | FormData: `src[]`, `dst` | Image bytes (PNG) |

---

## 8. Routes à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

| Path | Component | Description |
|------|-----------|-------------|
| `/` | `LandingPage` | à¸«à¸™à¹‰à¸²à¹à¸£à¸ à¹à¸ªà¸”à¸‡ hero section à¹à¸¥à¸° carousel |
| `/services` | `ServicesPage` | à¸£à¸²à¸¢à¸à¸²à¸£ services à¸—à¸µà¹ˆà¸¡à¸µ |
| `/tool/simswap-single` | `FaceSwapTool` | à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸¥à¸±à¸šà¸«à¸™à¹‰à¸²à¹€à¸”à¸µà¹ˆà¸¢à¸§ |
| `/tool/simswap-multi` | `FaceSwapTool` | à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸¥à¸±à¸šà¸«à¸¥à¸²à¸¢à¸«à¸™à¹‰à¸² |
| `/about` | `AboutPage` | à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹€à¸£à¸² |
| `/contact` | `ContactPage` | à¸•à¸´à¸”à¸•à¹ˆà¸­ |
| `/research` | `ResearchPage` | à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡ |

---

## 9. Components à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

### 9.1 Layout.jsx (85 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** Wrapper component à¸ªà¸³à¸«à¸£à¸±à¸š Header, Footer, à¹à¸¥à¸° Navigation

```jsx
function Layout() {
    const location = useLocation();  // à¸”à¸¹ current path

    return (
        <div className="layout">
            <header className="main-header">
                <Link to="/" className="logo">ğŸ­ FaceLab</Link>
                
                <nav className="main-nav">
                    <Link to="/" className={location.pathname === '/' ? 'active' : ''}>
                        Home
                    </Link>
                    {/* ... more links */}
                </nav>
                
                <div className="header-actions">
                    <ThemeToggle />
                    <a href="https://github.com/...">GitHub â†—</a>
                </div>
            </header>
            
            <main>
                <Outlet />  {/* Child routes render here */}
            </main>
            
            <footer>...</footer>
        </div>
    );
}
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ Outlet?**
- React Router 6+ pattern
- Parent route render layout, child routes render à¹ƒà¸™ `<Outlet />`
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ pass children manually

---

### 9.2 ImageUploader.jsx (209 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** Component à¸­à¸±à¸à¹‚à¸«à¸¥à¸”à¸£à¸¹à¸› à¸£à¸­à¸‡à¸£à¸±à¸š drag-drop à¹à¸¥à¸° multi-select

```jsx
function ImageUploader({
    onSourceChange,       // Callback à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸¥à¸·à¸­à¸ source file
    onSourceFilesChange,  // Callback à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸¥à¸·à¸­à¸à¸«à¸¥à¸²à¸¢ source files
    onTargetChange,       // Callback à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸¥à¸·à¸­à¸ target file
    sourceFile,
    sourceFiles = [],
    targetFile,
    isMultiMode = false   // Single vs Multi face swap
}) {
    const [dragOver, setDragOver] = useState({ source: false, target: false });
    
    // Drag & Drop handlers
    const handleDragOver = useCallback((e, type) => {
        e.preventDefault();
        e.stopPropagation();
        setDragOver(prev => ({ ...prev, [type]: true }));
    }, []);
    
    const handleDrop = useCallback((e, type, onChange, isMulti) => {
        e.preventDefault();
        const files = e.dataTransfer.files;
        
        if (isMulti) {
            // Filter only images
            const imageFiles = Array.from(files).filter(f => 
                f.type.startsWith('image/')
            );
            onChange(imageFiles);
        } else {
            onChange(files[0]);
        }
    }, []);
    
    // Create preview URL
    const createPreview = (file) => URL.createObjectURL(file);
    
    // ... render upload zones
}
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ useCallback?**
- à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ function à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸«à¸¡à¹ˆà¸—à¸¸à¸ render
- à¸ˆà¸³à¹€à¸›à¹‡à¸™à¹€à¸à¸£à¸²à¸° functions à¸–à¸¹à¸ pass à¹€à¸›à¹‡à¸™ props à¹ƒà¸«à¹‰ child components

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ URL.createObjectURL?**
- à¸ªà¸£à¹‰à¸²à¸‡ local URL à¸ªà¸³à¸«à¸£à¸±à¸š preview à¸£à¸¹à¸›
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ upload à¸à¹ˆà¸­à¸™ preview
- Memory efficient à¸à¸§à¹ˆà¸² Base64

---

### 9.3 FaceSwapTool.jsx (296 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸à¸‚à¸­à¸‡à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­ Face Swap à¸ˆà¸±à¸”à¸à¸²à¸£ state machine à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

```jsx
// App States - State Machine
const STATES = {
    UPLOAD: 'upload',      // à¸à¸³à¸¥à¸±à¸‡à¸­à¸±à¸à¹‚à¸«à¸¥à¸”à¸£à¸¹à¸›
    GENERATING: 'generating', // à¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥
    RESULT: 'result',      // à¹à¸ªà¸”à¸‡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ
    EDITING: 'editing'     // à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸ªà¸µ
};

function FaceSwapTool() {
    const location = useLocation();
    
    // Determine tool from URL
    const getInitialTool = () => {
        const pathParts = location.pathname.split('/');
        const toolFromUrl = pathParts[pathParts.length - 1];
        return ['simswap-single', 'simswap-multi'].includes(toolFromUrl)
            ? toolFromUrl
            : 'simswap-single';
    };
    
    const [selectedTool, setSelectedTool] = useState(getInitialTool);
    const [currentState, setCurrentState] = useState(STATES.UPLOAD);
    const [sourceFile, setSourceFile] = useState(null);
    const [sourceFiles, setSourceFiles] = useState([]);
    const [targetFile, setTargetFile] = useState(null);
    const [progress, setProgress] = useState(0);
    const [resultUrl, setResultUrl] = useState(null);
    const [error, setError] = useState(null);
    
    // Main generation handler
    const handleGenerate = async () => {
        try {
            setCurrentState(STATES.GENERATING);
            setProgress(10);
            setStatus('à¸à¸³à¸¥à¸±à¸‡à¸­à¸±à¸à¹‚à¸«à¸¥à¸”à¸£à¸¹à¸›à¸ à¸²à¸...');
            
            let result;
            if (isMultiMode) {
                result = await runSimSwapMulti(sourceFiles, targetFile);
            } else {
                result = await runSimSwap(sourceFile, targetFile);
            }
            
            setResultUrl(getResultImageUrl(result.result_url));
            setCurrentState(STATES.RESULT);
            
        } catch (err) {
            // Parse error for user-friendly message
            if (err.message.includes('face')) {
                setError('âŒ à¹„à¸¡à¹ˆà¸à¸šà¹ƒà¸šà¸«à¸™à¹‰à¸²à¹ƒà¸™à¸£à¸¹à¸›à¸ à¸²à¸');
            } else if (err.message.includes('unreachable')) {
                setError('âš ï¸ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¸š Backend à¹„à¸”à¹‰');
            }
            setCurrentState(STATES.UPLOAD);
        }
    };
    
    // Render based on state
    return (
        <div className="tool-page">
            {currentState === STATES.UPLOAD && <ImageUploader ... />}
            {currentState === STATES.GENERATING && <GenerationProgress ... />}
            {currentState === STATES.RESULT && <ResultDisplay ... />}
            {currentState === STATES.EDITING && <ColorEditor ... />}
        </div>
    );
}
```

**State Machine Pattern:**
```
UPLOAD â†’ (à¸à¸” Generate) â†’ GENERATING â†’ (à¸ªà¸³à¹€à¸£à¹‡à¸ˆ) â†’ RESULT â†’ (à¸à¸” Edit) â†’ EDITING
                              â†“ (error)
                           UPLOAD
```

---

### 9.4 ColorEditor.jsx (588 lines) - Component à¸«à¸¥à¸±à¸

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸ªà¸µ, à¸„à¸§à¸²à¸¡à¸ªà¸§à¹ˆà¸²à¸‡, contrast, à¹à¸¥à¸°à¸„à¸£à¸­à¸›à¸£à¸¹à¸›

à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹ƒà¸™à¸«à¸±à¸§à¸‚à¹‰à¸­à¸–à¸±à¸”à¹„à¸› (à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸ªà¸µ)

---

### 9.5 GenerationProgress.jsx (44 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** à¹à¸ªà¸”à¸‡à¸ªà¸–à¸²à¸™à¸°à¸‚à¸“à¸° AI à¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥

```jsx
function GenerationProgress({ isGenerating, progress, status }) {
    if (!isGenerating) return null;

    return (
        <div className="generation-progress">
            <div className="ai-icon">
                <span className="icon-pulse">ğŸ¤–</span>
            </div>
            
            <div className="progress-bar-container">
                <div className="progress-bar" 
                     style={{ width: `${progress}%` }} />
            </div>
            
            <p className="progress-status">{status}</p>
        </div>
    );
}
```

**Early Return Pattern:**
- à¸–à¹‰à¸² `!isGenerating` return `null` à¸—à¸±à¸™à¸—à¸µ
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸„à¸£à¸­à¸š condition à¸—à¸±à¹‰à¸‡ JSX

---

### 9.6 ResultDisplay.jsx (132 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** à¹à¸ªà¸”à¸‡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹à¸šà¸šà¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸š Source + Target = Result

```jsx
function ResultDisplay({
    sourceFile,
    sourceFiles = [],
    targetFile,
    resultUrl,
    onReset,
    onProceedToEdit,
    isMultiMode = false
}) {
    // Handle download
    const handleDownload = async () => {
        const response = await fetch(resultUrl);
        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `facelab_result_${Date.now()}.png`;
        a.click();
        
        window.URL.revokeObjectURL(url);  // Clean up
    };
    
    return (
        <div className="comparison-view">
            {/* Source + Target = Result */}
            <div className="comparison-item">
                <img src={URL.createObjectURL(sourceFile)} />
            </div>
            <div className="operator">+</div>
            <div className="comparison-item">
                <img src={URL.createObjectURL(targetFile)} />
            </div>
            <div className="operator">=</div>
            <div className="comparison-item result">
                <img src={resultUrl} />
            </div>
        </div>
    );
}
```

**Download Pattern:**
1. Fetch à¸£à¸¹à¸›à¹€à¸›à¹‡à¸™ blob
2. à¸ªà¸£à¹‰à¸²à¸‡ object URL
3. à¸ªà¸£à¹‰à¸²à¸‡ invisible `<a>` element
4. Trigger click
5. Revoke URL à¹€à¸à¸·à¹ˆà¸­ free memory

---

### 9.7 ThemeToggle.jsx (21 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** à¸›à¸¸à¹ˆà¸¡à¸ªà¸¥à¸±à¸š Dark/Light mode

```jsx
function ThemeToggle() {
    const { theme, toggleTheme } = useTheme();

    return (
        <button className="theme-toggle" onClick={toggleTheme}>
            <span className="theme-icon">
                {theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'}
            </span>
        </button>
    );
}
```

**à¸‡à¹ˆà¸²à¸¢à¹à¸„à¹ˆà¸™à¸µà¹‰à¹€à¸à¸£à¸²à¸°:**
- Logic à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ ThemeContext
- Component à¸™à¸µà¹‰à¹à¸„à¹ˆ render à¹à¸¥à¸° trigger

---

### 9.8 LuxuryCarousel.jsx (152 lines)

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:** Auto-sliding image carousel à¸ªà¸³à¸«à¸£à¸±à¸šà¸«à¸™à¹‰à¸²à¹à¸£à¸

```jsx
function LuxuryCarousel() {
    const [currentIndex, setCurrentIndex] = useState(0);
    const [progress, setProgress] = useState(0);
    
    const nextSlide = useCallback(() => {
        setCurrentIndex(prev => (prev + 1) % images.length);
        setProgress(0);
    }, []);
    
    // Auto-play with progress bar
    useEffect(() => {
        const interval = setInterval(() => {
            setProgress(prev => {
                if (prev >= 100) {
                    nextSlide();
                    return 0;
                }
                return prev + 1;
            });
        }, 50);  // Update every 50ms
        
        return () => clearInterval(interval);
    }, [nextSlide]);
    
    return (
        <div className="carousel-container">
            {images.map((img, i) => (
                <div className={`slide ${i === currentIndex ? 'active' : ''}`}>
                    <div style={{ backgroundImage: `url(${img.url})` }} />
                </div>
            ))}
            
            {/* Progress dots */}
            <div className="carousel-dots">
                {images.map((_, i) => (
                    <button className="dot">
                        <div className="dot-progress" 
                             style={{ width: i === currentIndex ? `${progress}%` : 0 }} />
                    </button>
                ))}
            </div>
        </div>
    );
}
```

**Auto-play Algorithm:**
- `setInterval` à¸—à¸¸à¸ 50ms à¹€à¸à¸´à¹ˆà¸¡ progress 1%
- à¹€à¸¡à¸·à¹ˆà¸­ progress = 100 â†’ next slide
- Total time per slide = 50ms Ã— 100 = 5 seconds

---

## 10. à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸ªà¸µ

### 10.1 CSS Filter Functions

ColorEditor à¹ƒà¸Šà¹‰ **CSS Filter** à¹ƒà¸™à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸ªà¸µ à¸‹à¸¶à¹ˆà¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸šà¸™ GPU:

```jsx
const getFilterString = useCallback(() => {
    const filters = [
        `brightness(${adjustments.brightness}%)`,  // 0-200%
        `contrast(${adjustments.contrast}%)`,      // 0-200%
        `saturate(${adjustments.saturation}%)`,    // 0-200%
    ];
    
    // Temperature adjustment
    if (adjustments.temperature > 0) {
        // Warm tone: add sepia
        filters.push(`sepia(${adjustments.temperature}%)`);
    } else if (adjustments.temperature < 0) {
        // Cool tone: rotate hue toward blue
        filters.push(`hue-rotate(${adjustments.temperature * 2}deg)`);
    }
    
    return filters.join(' ');
}, [adjustments]);
```

### 10.2 à¸ªà¸¹à¸•à¸£à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹à¸•à¹ˆà¸¥à¸° Filter

#### Brightness
```
Output = Input Ã— (brightness / 100)
```
- brightness = 100: à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
- brightness = 50: à¸¡à¸·à¸”à¸¥à¸‡à¸„à¸£à¸¶à¹ˆà¸‡à¸«à¸™à¸¶à¹ˆà¸‡
- brightness = 200: à¸ªà¸§à¹ˆà¸²à¸‡à¸‚à¸¶à¹‰à¸™ 2 à¹€à¸—à¹ˆà¸²

#### Contrast
```
Factor = (259 Ã— (contrast + 255)) / (255 Ã— (259 - contrast))
Output = Factor Ã— (Input - 128) + 128
```
- contrast = 100: à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
- contrast < 100: à¸ªà¸µà¸ˆà¸·à¸”à¸¥à¸‡ (à¹€à¸‚à¹‰à¸²à¸«à¸² gray)
- contrast > 100: à¸ªà¸µà¹€à¸‚à¹‰à¸¡à¸‚à¸¶à¹‰à¸™ (à¸•à¹ˆà¸²à¸‡à¸Šà¸±à¸”à¸‚à¸¶à¹‰à¸™)

#### Saturation
```
Gray = 0.2126Ã—R + 0.7152Ã—G + 0.0722Ã—B  // Luminance
Output = Gray + (Input - Gray) Ã— (saturation / 100)
```
- saturation = 0: à¸‚à¸²à¸§à¸”à¸³
- saturation = 100: à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™
- saturation = 200: à¸ªà¸µà¸­à¸´à¹ˆà¸¡à¸•à¸±à¸§à¸‚à¸¶à¹‰à¸™ 2 à¹€à¸—à¹ˆà¸²

#### Temperature (Warm/Cool)

**Warm (sepia):**
```
R' = R Ã— 0.95 + G Ã— 0.05
G' = G Ã— 0.85
B' = B Ã— 0.70
```

**Cool (hue-rotate):**
```
Î¸ = temperature Ã— 2 degrees
[R']   [cos(Î¸)  -sin(Î¸)  0] [R]
[G'] = [sin(Î¸)   cos(Î¸)  0] [G]
[B']   [0        0       1] [B]
```

### 10.3 Canvas-based Apply

```jsx
const applyToResultCanvas = useCallback(() => {
    const canvas = canvasRef.current;
    const ctx = canvas.getContext('2d');
    const img = originalImageRef.current;
    
    // Set canvas size to crop area
    canvas.width = Math.round(cropArea.width);
    canvas.height = Math.round(cropArea.height);
    
    // Apply CSS filters
    ctx.filter = getFilterString();
    
    // Draw cropped region
    ctx.drawImage(
        img,
        cropArea.x, cropArea.y,           // Source position
        cropArea.width, cropArea.height,  // Source size
        0, 0,                             // Destination position
        cropArea.width, cropArea.height   // Destination size
    );
}, [cropArea, getFilterString]);
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ Canvas?**
- à¸ªà¸²à¸¡à¸²à¸£à¸– export à¹€à¸›à¹‡à¸™ PNG à¹„à¸”à¹‰
- Hardware accelerated
- à¸£à¸­à¸‡à¸£à¸±à¸š `ctx.filter` property

### 10.4 Crop Algorithm

```jsx
// Corner handles for resizing
const handles = {
    nw: { x: cropArea.x, y: cropArea.y },
    ne: { x: cropArea.x + cropArea.width, y: cropArea.y },
    sw: { x: cropArea.x, y: cropArea.y + cropArea.height },
    se: { x: cropArea.x + cropArea.width, y: cropArea.y + cropArea.height }
};

// Drag resize logic
if (dragHandle === 'se') {  // Southeast corner
    newCrop.width = Math.max(50, 
        Math.min(dragStart.cropWidth + deltaX, 
                 img.naturalWidth - dragStart.cropX));
    newCrop.height = Math.max(50, 
        Math.min(dragStart.cropHeight + deltaY, 
                 img.naturalHeight - dragStart.cropY));
}
```

**Constraints:**
- Minimum size: 50Ã—50 pixels
- Maximum: à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™à¸‚à¸­à¸šà¸£à¸¹à¸›
- Move: à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸«à¸¥à¸¸à¸”à¸‚à¸­à¸š

---

## 11. à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™

### 11.1 Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER WORKFLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. à¹€à¸›à¸´à¸”à¹€à¸§à¹‡à¸š localhost:5173
        â”‚
        â–¼
2. à¸«à¸™à¹‰à¸² Landing Page
   â”œâ”€â”€ à¸”à¸¹ Carousel à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡
   â””â”€â”€ à¸à¸” "Get Started" à¸«à¸£à¸·à¸­ "Services"
        â”‚
        â–¼
3. à¸«à¸™à¹‰à¸² Services
   â”œâ”€â”€ à¹€à¸¥à¸·à¸­à¸ "Face Swap" (Single)
   â””â”€â”€ à¸«à¸£à¸·à¸­ "Multi Face Swap"
        â”‚
        â–¼
4. à¸«à¸™à¹‰à¸² FaceSwapTool (State: UPLOAD)
   â”œâ”€â”€ à¸­à¸±à¸à¹‚à¸«à¸¥à¸” Source Image (à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸ˆà¸°à¸™à¸³à¹„à¸›à¹ƒà¸ªà¹ˆ)
   â””â”€â”€ à¸­à¸±à¸à¹‚à¸«à¸¥à¸” Target Image (à¸£à¸¹à¸›à¸—à¸µà¹ˆà¸ˆà¸°à¸–à¸¹à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸«à¸™à¹‰à¸²)
        â”‚
        â–¼
5. à¸à¸” "à¹€à¸£à¸´à¹ˆà¸¡à¸ªà¸£à¹‰à¸²à¸‡à¸ à¸²à¸"
        â”‚
        â–¼
6. State: GENERATING
   â”‚  Frontend: api.js â†’ runSimSwap()
   â”‚      â”‚
   â”‚      â–¼ POST /api/simswap with FormData
   â”‚  Gateway (port 8000):
   â”‚      â”‚
   â”‚      â–¼ Forward to SimSwap Service
   â”‚  SimSwap Service (port 8001):
   â”‚      â”œâ”€â”€ Save uploads to shared_storage/uploads/
   â”‚      â”œâ”€â”€ Load SimSwap model
   â”‚      â”œâ”€â”€ Detect faces with InsightFace
   â”‚      â”œâ”€â”€ Extract face embeddings
   â”‚      â”œâ”€â”€ Generate swapped face
   â”‚      â””â”€â”€ Save result to shared_storage/outputs/
   â”‚      â”‚
   â”‚      â–¼ Return image bytes
   â”‚  Gateway:
   â”‚      â””â”€â”€ Save as static/simswap_result.png
   â”‚      â”‚
   â”‚      â–¼ Return JSON: {"result_url": "/static/simswap_result.png"}
   â”‚  Frontend:
   â”‚      â””â”€â”€ Update state to RESULT
        â”‚
        â–¼
7. State: RESULT
   â”œâ”€â”€ à¹à¸ªà¸”à¸‡à¸œà¸¥: Source + Target = Result
   â”œâ”€â”€ à¸à¸” "à¹€à¸£à¸´à¹ˆà¸¡à¹ƒà¸«à¸¡à¹ˆ" â†’ à¸à¸¥à¸±à¸š State UPLOAD
   â”œâ”€â”€ à¸à¸” "à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”" â†’ Download à¸£à¸¹à¸›
   â””â”€â”€ à¸à¸” "à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸ªà¸µ" â†’ à¹„à¸› State EDITING
        â”‚
        â–¼
8. State: EDITING (ColorEditor)
   â”œâ”€â”€ à¸›à¸£à¸±à¸š Brightness (0-200%)
   â”œâ”€â”€ à¸›à¸£à¸±à¸š Contrast (0-200%)
   â”œâ”€â”€ à¸›à¸£à¸±à¸š Saturation (0-200%)
   â”œâ”€â”€ à¸›à¸£à¸±à¸š Temperature (-50 to +50)
   â”œâ”€â”€ à¹€à¸›à¸´à¸” Crop mode â†’ à¸›à¸£à¸±à¸šà¸‚à¸™à¸²à¸”
   â””â”€â”€ à¸à¸” "à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”" â†’ Export PNG
```

### 11.2 SimSwap AI Process (à¸ à¸²à¸¢à¹ƒà¸™)

```
Input: Source Face + Target Image
        â”‚
        â–¼
1. Face Detection (InsightFace)
   â”œâ”€â”€ Detect faces in source image
   â””â”€â”€ Detect faces in target image
        â”‚
        â–¼
2. Face Alignment
   â””â”€â”€ Align faces using facial landmarks
       (eyes, nose, mouth positions)
        â”‚
        â–¼
3. Feature Extraction (ArcFace)
   â””â”€â”€ Extract 512-D face embedding from source face
        â”‚
        â–¼
4. Face Swapping (SimSwap Generator)
   â”œâ”€â”€ Input: Target face region + Source embedding
   â””â”€â”€ Output: Synthesized face with source identity
        â”‚
        â–¼
5. Blending
   â””â”€â”€ Seamlessly blend swapped face into target image
        â”‚
        â–¼
Output: Result Image
```

---

## 12. CSS Design System (index.css)

### 12.1 CSS Variables

```css
:root {
    /* Colors - Light Theme */
    --bg-primary: #fdfbf9;
    --bg-secondary: #ffffff;
    --text-primary: #1e293b;
    --text-secondary: #64748b;
    
    /* Gradients */
    --gradient-primary: linear-gradient(135deg, #d946ef 0%, #8b5cf6 100%);
    
    /* Shadows */
    --shadow-card: 0 4px 24px rgba(0, 0, 0, 0.04);
    
    /* Spacing Scale */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;
    
    /* Border Radius */
    --radius-sm: 6px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-full: 9999px;  /* Pill shape */
    
    /* Transitions */
    --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Dark Theme Override */
[data-theme="dark"] {
    --bg-primary: #0a0f1a;
    --text-primary: #f8fafc;
    --gradient-primary: linear-gradient(135deg, #8b5cf6 0%, #d946ef 50%, #f97316 100%);
    --shadow-neon: 0 0 20px rgba(139, 92, 246, 0.5);
}
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ CSS Variables?**
- à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ theme à¹„à¸”à¹‰à¸—à¸±à¸™à¸—à¸µà¹‚à¸”à¸¢à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ `data-theme`
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ re-render JavaScript
- Maintainable à¹à¸¥à¸° consistent

### 12.2 Button Styles

```css
.btn {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-sm) var(--spacing-lg);
    border-radius: var(--radius-full);  /* Pill shape */
    font-weight: 500;
    transition: all var(--transition-fast);
}

.btn-primary {
    background: var(--gradient-primary);
    color: white;
    box-shadow: 0 4px 12px rgba(168, 85, 247, 0.25);
}

.btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(168, 85, 247, 0.35);
}
```

**Hover Effect:**
- `translateY(-2px)` - à¸›à¸¸à¹ˆà¸¡à¸¥à¸­à¸¢à¸‚à¸¶à¹‰à¸™
- à¹€à¸à¸´à¹ˆà¸¡ shadow blur à¹à¸¥à¸° spread
- à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸ªà¸¶à¸ "à¸à¸”" à¹„à¸”à¹‰

### 12.3 Animations

```css
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.animate-slideUp {
    animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}
```

**cubic-bezier(0.16, 1, 0.3, 1):**
- à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸£à¹‡à¸§ à¸„à¹ˆà¸­à¸¢à¹† à¸Šà¹‰à¸²à¸¥à¸‡
- "Ease out expo" feeling
- à¸”à¸¹à¹€à¸›à¹‡à¸™à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´

---

## à¸ªà¸£à¸¸à¸›

FaceLab à¹€à¸›à¹‡à¸™à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¸—à¸µà¹ˆà¸£à¸§à¸¡:
- **Modern Frontend** à¸”à¹‰à¸§à¸¢ React 19 + Vite
- **Microservices Backend** à¸”à¹‰à¸§à¸¢ FastAPI
- **AI/ML** à¸”à¹‰à¸§à¸¢ SimSwap + InsightFace
- **Premium UI/UX** à¸”à¹‰à¸§à¸¢ CSS Variables + Animations

à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¢à¸ Layer à¸Šà¸±à¸”à¹€à¸ˆà¸™ à¸—à¸³à¹ƒà¸«à¹‰ maintain à¹à¸¥à¸° scale à¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢.
